using System;
using System.Collections.Generic;
using System.Linq;
					
public class Program
{	
	public static void Main()
	{
		var readings = input.Split(new string[] { "\r\n" }, StringSplitOptions.None);
	
		List<Tuple<int, int>> coords = new List<Tuple<int, int>>();
		int i = 0;
		while (i < readings.Length)
		{	
			var  split = readings[i].Split(new string[] { "," }, StringSplitOptions.None);
			if (split.Count() != 2)
			{
				i++;
				break;
			}
			coords.Add(new Tuple<int, int>(Int32.Parse(split[0]), Int32.Parse(split[1])));			
			i++;
		}	
		
		
		List<Tuple<int, int>> coordsFolded = fold(coords, 
					 readings[i][11], 
					 Int32.Parse(readings[i].Split(new string[] { "=" }, StringSplitOptions.None)[1]));
				
		List<string> coordsFoldedString = new List<string>();
		foreach(var coord in coordsFolded)
		{
			coordsFoldedString.Add(coord.Item1+"," + coord.Item2);
		}
		
		var coordsFoldedDisinct = coordsFoldedString.Distinct();
		Console.WriteLine(coordsFoldedDisinct.Count());		
	}
	
	public static List<Tuple<int, int>> fold(List<Tuple<int, int>> origCoords, char axis, int num)
	{
		List<Tuple<int, int>> newCoords = new List<Tuple<int, int>>();
		foreach (var origCoord in origCoords)
		{
			if (axis == 'x')
			{
				if (origCoord.Item1 < num)
				{
					newCoords.Add(new Tuple<int, int>(origCoord.Item1, origCoord.Item2));
				}
				else
				{
					newCoords.Add(new Tuple<int, int>(origCoord.Item1 - (origCoord.Item1 - num)*2, origCoord.Item2));
				}
			}
			else
			{				
				if (origCoord.Item2 < num)
				{
					newCoords.Add(new Tuple<int, int>(origCoord.Item1, origCoord.Item2));
				}
				else
				{	
					newCoords.Add(new Tuple<int, int>(origCoord.Item1,origCoord.Item2 - (origCoord.Item2 - num)*2));		
				}
			}
		}
		
		return newCoords;
	}
	
	private static string input = "522,329\r\n174,466\r\n242,714\r\n785,686\r\n378,596\r\n335,353\r\n229,44\r\n1160,19\r\n5,318\r\n489,63\r\n484,275\r\n818,774\r\n214,882\r\n1128,519\r\n1143,432\r\n627,217\r\n669,544\r\n306,191\r\n878,199\r\n579,376\r\n649,121\r\n1004,191\r\n1017,838\r\n519,329\r\n62,228\r\n249,733\r\n1275,108\r\n569,173\r\n1297,686\r\n23,187\r\n5,576\r\n823,462\r\n730,395\r\n1049,309\r\n843,35\r\n164,364\r\n448,373\r\n50,372\r\n74,723\r\n970,539\r\n569,33\r\n579,605\r\n1126,750\r\n801,742\r\n525,726\r\n293,844\r\n334,686\r\n21,262\r\n514,617\r\n1303,541\r\n816,136\r\n211,284\r\n283,833\r\n887,119\r\n800,823\r\n559,131\r\n1077,695\r\n579,206\r\n764,350\r\n492,120\r\n1103,803\r\n229,850\r\n582,785\r\n1124,442\r\n676,863\r\n897,350\r\n45,32\r\n126,777\r\n1256,621\r\n853,862\r\n550,771\r\n1299,723\r\n328,728\r\n907,737\r\n296,310\r\n110,592\r\n780,850\r\n822,72\r\n1081,44\r\n964,649\r\n443,817\r\n681,8\r\n853,638\r\n796,617\r\n1148,728\r\n878,647\r\n371,385\r\n826,619\r\n820,728\r\n413,481\r\n136,145\r\n585,871\r\n549,187\r\n554,133\r\n112,166\r\n1092,621\r\n299,14\r\n1002,245\r\n1078,100\r\n1198,186\r\n104,535\r\n710,427\r\n197,549\r\n1067,47\r\n1144,136\r\n643,115\r\n361,56\r\n811,68\r\n452,486\r\n146,700\r\n822,408\r\n641,462\r\n346,801\r\n1232,24\r\n966,749\r\n160,584\r\n1151,462\r\n853,222\r\n1241,751\r\n457,704\r\n378,298\r\n109,341\r\n160,310\r\n324,310\r\n1051,651\r\n502,413\r\n103,856\r\n997,649\r\n1061,544\r\n515,483\r\n1183,359\r\n537,558\r\n401,801\r\n579,768\r\n827,93\r\n63,406\r\n0,838\r\n1084,245\r\n1001,70\r\n1275,862\r\n328,812\r\n984,728\r\n1285,438\r\n167,208\r\n1268,374\r\n392,609\r\n145,51\r\n793,771\r\n1069,798\r\n186,442\r\n716,469\r\n604,371\r\n904,439\r\n217,887\r\n661,859\r\n284,374\r\n542,855\r\n465,347\r\n393,596\r\n607,670\r\n1210,627\r\n887,327\r\n1272,856\r\n682,117\r\n832,436\r\n552,421\r\n472,519\r\n1299,733\r\n939,385\r\n1054,19\r\n560,772\r\n1283,238\r\n248,551\r\n1260,820\r\n907,157\r\n341,21\r\n853,32\r\n728,109\r\n127,550\r\n768,186\r\n129,799\r\n1166,381\r\n440,858\r\n1198,166\r\n1215,543\r\n509,742\r\n783,359\r\n981,696\r\n0,306\r\n1141,564\r\n616,40\r\n653,738\r\n1086,535\r\n110,32\r\n492,225\r\n1093,887\r\n214,12\r\n1237,488\r\n155,765\r\n1310,52\r\n764,670\r\n847,551\r\n488,150\r\n378,227\r\n1247,406\r\n45,823\r\n1113,856\r\n187,483\r\n344,749\r\n1303,801\r\n1210,425\r\n42,822\r\n60,546\r\n811,765\r\n648,686\r\n542,75\r\n222,199\r\n912,467\r\n841,780\r\n243,399\r\n1263,670\r\n30,758\r\n1048,609\r\n115,593\r\n731,518\r\n50,591\r\n345,70\r\n723,651\r\n92,770\r\n17,371\r\n957,792\r\n350,135\r\n656,56\r\n465,858\r\n378,746\r\n174,428\r\n689,56\r\n895,289\r\n485,240\r\n567,498\r\n1165,152\r\n497,16\r\n1049,522\r\n1198,523\r\n232,497\r\n915,686\r\n50,599\r\n791,329\r\n589,309\r\n616,380\r\n1198,728\r\n190,19\r\n237,68\r\n47,670\r\n621,681\r\n422,322\r\n373,303\r\n288,745\r\n1200,592\r\n545,679\r\n1088,199\r\n1208,85\r\n335,93\r\n326,728\r\n743,396\r\n981,472\r\n1144,758\r\n110,750\r\n932,390\r\n1119,791\r\n964,351\r\n1193,784\r\n503,588\r\n180,28\r\n706,295\r\n253,241\r\n853,670\r\n756,627\r\n1034,876\r\n20,253\r\n633,296\r\n432,199\r\n970,114\r\n584,845\r\n1078,397\r\n293,96\r\n288,518\r\n740,287\r\n691,456\r\n344,642\r\n194,5\r\n713,75\r\n828,855\r\n72,221\r\n845,347\r\n169,635\r\n528,49\r\n1113,336\r\n447,539\r\n102,546\r\n1146,166\r\n1121,771\r\n306,703\r\n1226,852\r\n575,495\r\n527,135\r\n1181,224\r\n703,170\r\n1108,38\r\n428,649\r\n982,364\r\n1159,759\r\n512,302\r\n189,795\r\n641,544\r\n853,220\r\n494,856\r\n740,735\r\n1121,547\r\n413,413\r\n108,350\r\n87,371\r\n314,117\r\n659,278\r\n534,179\r\n144,890\r\n768,819\r\n872,862\r\n1081,421\r\n257,31\r\n964,693\r\n171,801\r\n766,123\r\n478,684\r\n669,208\r\n1071,137\r\n1290,880\r\n207,61\r\n594,298\r\n758,546\r\n870,690\r\n371,539\r\n1057,401\r\n845,858\r\n888,497\r\n913,397\r\n776,379\r\n1017,112\r\n129,560\r\n1150,584\r\n65,137\r\n52,183\r\n378,876\r\n880,535\r\n331,432\r\n870,280\r\n447,61\r\n102,473\r\n585,845\r\n1168,592\r\n1149,383\r\n679,707\r\n731,352\r\n1195,560\r\n1046,537\r\n1193,558\r\n904,455\r\n803,137\r\n982,504\r\n1277,56\r\n600,273\r\n69,845\r\n460,889\r\n89,577\r\n3,761\r\n5,240\r\n470,359\r\n986,584\r\n813,228\r\n269,411\r\n311,828\r\n497,635\r\n726,875\r\n771,301\r\n639,757\r\n224,535\r\n197,336\r\n591,182\r\n144,101\r\n748,49\r\n1280,115\r\n201,453\r\n1265,71\r\n909,801\r\n1238,225\r\n299,105\r\n1153,635\r\n17,523\r\n69,703\r\n85,686\r\n440,12\r\n361,504\r\n57,728\r\n621,838\r\n785,168\r\n403,157\r\n395,686\r\n624,136\r\n594,596\r\n1078,845\r\n197,793\r\n836,364\r\n218,672\r\n710,273\r\n490,550\r\n1111,851\r\n674,767\r\n846,875\r\n574,849\r\n1181,799\r\n254,486\r\n843,187\r\n838,4\r\n325,248\r\n1163,533\r\n405,96\r\n288,149\r\n627,117\r\n497,666\r\n325,24\r\n65,148\r\n21,150\r\n377,388\r\n910,486\r\n1201,553\r\n870,217\r\n1225,413\r\n1164,82\r\n850,889\r\n1158,481\r\n484,843\r\n120,179\r\n1165,483\r\n647,801\r\n499,826\r\n1004,703\r\n117,558\r\n341,686\r\n795,411\r\n1104,155\r\n176,427\r\n826,843\r\n662,14\r\n676,686\r\n855,550\r\n68,322\r\n206,494\r\n1299,171\r\n969,798\r\n363,704\r\n728,673\r\n1245,157\r\n1245,605\r\n1086,516\r\n1289,184\r\n815,392\r\n870,858\r\n1163,361\r\n1130,866\r\n436,96\r\n587,651\r\n127,359\r\n1277,325\r\n908,686\r\n1226,159\r\n550,571\r\n1185,161\r\n206,739\r\n54,621\r\n36,497\r\n977,325\r\n174,876\r\n949,350\r\n248,870\r\n1253,280\r\n870,815\r\n1250,544\r\n253,493\r\n947,704\r\n361,95\r\n585,703\r\n820,550\r\n710,467\r\n129,480\r\n1017,262\r\n683,217\r\n346,127\r\n992,716\r\n820,812\r\n582,221\r\n1265,519\r\n1022,380\r\n604,36\r\n1017,56\r\n7,93\r\n151,759\r\n1240,19\r\n1056,486\r\n1299,609\r\n760,571\r\n182,65\r\n483,93\r\n464,19\r\n1265,319\r\n1039,233\r\n960,135\r\n84,735\r\n142,592\r\n979,392\r\n607,170\r\n1250,425\r\n484,619\r\n5,688\r\n629,8\r\n676,31\r\n1251,528\r\n917,737\r\n1292,435\r\n1151,840\r\n1139,801\r\n1158,635\r\n152,413\r\n1134,436\r\n174,18\r\n1251,814\r\n189,771\r\n832,684\r\n184,144\r\n1049,585\r\n872,592\r\n60,21\r\n969,21\r\n838,890\r\n997,432\r\n78,870\r\n525,215\r\n1136,466\r\n233,616\r\n1078,794\r\n428,245\r\n495,392\r\n1265,480\r\n1049,421\r\n801,152\r\n1011,789\r\n919,264\r\n1049,697\r\n1113,38\r\n176,436\r\n561,891\r\n663,577\r\n488,584\r\n378,675\r\n989,325\r\n853,856\r\n1210,133\r\n1000,866\r\n408,805\r\n689,838\r\n1293,371\r\n197,215\r\n949,504\r\n574,89\r\n229,137\r\n313,432\r\n1260,303\r\n986,310\r\n716,298\r\n1014,584\r\n628,117\r\n1029,787\r\n1121,562\r\n211,560\r\n701,414\r\n1202,350\r\n847,343\r\n1265,862\r\n21,184\r\n1225,481\r\n654,56\r\n525,168\r\n472,228\r\n366,402\r\n969,686\r\n482,407\r\n145,499\r\n448,43\r\n818,120\r\n78,714\r\n949,544\r\n725,871\r\n525,110\r\n764,224\r\n760,459\r\n575,362\r\n840,359\r\n850,558\r\n654,838\r\n917,585\r\n621,280\r\n853,674\r\n176,210\r\n582,225\r\n1166,513\r\n647,317\r\n816,310\r\n611,763\r\n1263,224\r\n750,217\r\n985,248\r\n803,316\r\n65,309\r\n634,863\r\n932,18\r\n75,542\r\n780,44\r\n492,774\r\n1124,452\r\n962,852\r\n75,518\r\n467,35\r\n162,669\r\n266,574\r\n1210,469\r\n100,425\r\n962,583\r\n50,522\r\n129,663\r\n161,86\r\n306,852\r\n515,411\r\n110,526\r\n1181,543\r\n897,413\r\n1099,112\r\n499,68\r\n992,178\r\n189,123\r\n348,486\r\n190,427\r\n1061,96\r\n1268,624\r\n478,236\r\n677,296\r\n1164,700\r\n821,63\r\n796,890\r\n509,152\r\n798,592\r\n746,780\r\n510,101\r\n1069,544\r\n354,525\r\n514,4\r\n120,379\r\n904,551\r\n1125,780\r\n964,245\r\n276,667\r\n579,654\r\n785,320\r\n656,52\r\n1155,765\r\n309,70\r\n1084,627\r\n1215,95\r\n27,432\r\n146,252\r\n114,164\r\n109,789\r\n306,759\r\n706,523\r\n1200,526\r\n766,750\r\n1009,120\r\n440,79\r\n1307,761\r\n1220,780\r\n333,325\r\n164,812\r\n1019,332\r\n960,311\r\n328,504\r\n38,38\r\n800,549\r\n35,414\r\n1002,543\r\n73,499\r\n237,317\r\n1154,798\r\n945,453\r\n348,529\r\n1215,763\r\n826,499\r\n364,497\r\n498,843\r\n1029,107\r\n713,166\r\n276,504\r\n388,574\r\n190,145\r\n1017,504\r\n795,483\r\n795,35\r\n385,838\r\n785,768\r\n825,575\r\n478,458\r\n393,585\r\n710,621\r\n554,469\r\n698,270\r\n1093,7\r\n651,278\r\n1123,859\r\n100,627\r\n321,325\r\n713,523\r\n1184,117\r\n1232,714\r\n559,95\r\n1004,759\r\n1010,369\r\n306,255\r\n710,691\r\n373,367\r\n1200,32\r\n823,432\r\n42,744\r\n1096,79\r\n782,49\r\n631,483\r\n600,691\r\n628,777\r\n485,575\r\n160,136\r\n539,558\r\n783,135\r\n224,208\r\n1094,32\r\n232,546\r\n79,495\r\n1103,733\r\n820,166\r\n1113,32\r\n1241,255\r\n985,696\r\n915,651\r\n997,245\r\n253,353\r\n843,707\r\n110,302\r\n991,353\r\n648,880\r\n1136,876\r\n187,35\r\n45,71\r\n808,481\r\n364,397\r\n452,402\r\n423,119\r\n42,374\r\n766,144\r\n636,127\r\n726,845\r\n30,115\r\n661,35\r\n229,473\r\n691,480\r\n917,596\r\n1223,742\r\n731,376\r\n801,51\r\n843,411\r\n1245,869\r\n494,310\r\n569,861\r\n243,847\r\n514,890\r\n820,225\r\n1113,793\r\n776,627\r\n822,632\r\n11,723\r\n182,345\r\n863,803\r\n1139,689\r\n1084,649\r\n989,857\r\n467,483\r\n889,891\r\n1206,359\r\n395,880\r\n27,677\r\n713,411\r\n465,410\r\n701,527\r\n1057,849\r\n169,319\r\n669,96\r\n1128,345\r\n949,462\r\n966,642\r\n1183,135\r\n432,247\r\n915,880\r\n1277,838\r\n448,739\r\n467,187\r\n832,210\r\n472,381\r\n785,374\r\n564,780\r\n402,686\r\n1155,129\r\n62,666\r\n557,186\r\n668,220\r\n436,798\r\n393,309\r\n184,141\r\n465,123\r\n783,759\r\n619,414\r\n361,544\r\n1155,541\r\n1069,721\r\n530,44\r\n910,109\r\n924,871\r\n460,558\r\n440,751\r\n621,351\r\n191,791\r\n85,693\r\n749,278\r\n164,728\r\n822,744\r\n226,627\r\n1292,693\r\n256,427\r\n447,355\r\n982,812\r\n1260,522\r\n346,245\r\n129,112\r\n1119,551\r\n1250,21\r\n1241,143\r\n955,441\r\n1272,38\r\n525,231\r\n326,364\r\n1181,768\r\n276,743\r\n1052,453\r\n169,778\r\n1268,822\r\n1277,880\r\n299,432\r\n1285,786\r\n472,4\r\n129,208\r\n45,862\r\n874,544\r\n933,388\r\n760,435\r\n209,336\r\n627,656\r\n214,751\r\n585,639\r\n1195,593\r\n1126,141\r\n1181,208\r\n773,784\r\n233,423\r\n113,388\r\n23,259\r\n1126,359\r\n1235,799\r\n1136,428\r\n1245,137\r\n33,632\r\n257,143\r\n662,238\r\n152,635\r\n1057,541\r\n607,224\r\n557,708\r\n1238,673\r\n25,438\r\n1067,399\r\n351,411\r\n385,411\r\n539,294\r\n964,543\r\n940,821\r\n1081,473\r\n493,383\r\n1141,857\r\n155,516\r\n982,728\r\n129,224\r\n1198,763\r\n816,856\r\n959,411\r\n1084,693\r\n1053,143\r\n723,243\r\n1292,106\r\n731,654\r\n115,301\r\n760,771\r\n171,541\r\n569,693\r\n145,395\r\n197,668\r\n554,425\r\n771,558\r\n528,117\r\n653,47\r\n59,80\r\n567,396\r\n1303,353\r\n782,777\r\n147,361\r\n109,679\r\n42,72\r\n7,801\r\n348,408\r\n994,578\r\n12,562\r\n701,476\r\n115,560\r\n455,43\r\n329,696\r\n1166,890\r\n145,843\r\n619,862\r\n721,309\r\n1073,68\r\n1181,480\r\n338,316\r\n1004,135\r\n72,109\r\n880,473\r\n842,442\r\n1280,779\r\n546,497\r\n395,651\r\n1053,79\r\n1168,190\r\n436,126\r\n519,565\r\n84,852\r\n222,834\r\n60,544\r\n728,225\r\n933,170\r\n330,366\r\n1064,805\r\n457,856\r\n277,388\r\n124,520\r\n1260,599\r\n171,93\r\n1068,831\r\n59,528\r\n1195,301\r\n155,541\r\n508,194\r\n1305,576\r\n1207,38\r\n691,414\r\n262,609\r\n962,529\r\n54,19\r\n796,4\r\n365,441\r\n913,79\r\n100,469\r\n95,763\r\n1053,563\r\n390,515\r\n1168,302\r\n142,190\r\n802,252\r\n1113,215\r\n490,344\r\n1253,483\r\n552,546\r\n517,562\r\n550,359\r\n326,166\r\n1166,823\r\n542,708\r\n500,850\r\n512,592\r\n817,383\r\n166,758\r\n1141,654\r\n166,408\r\n768,131\r\n316,316\r\n589,148\r\n490,812\r\n1010,777\r\n\r\nfold along x=655\r\nfold along y=447\r\nfold along x=327\r\nfold along y=223\r\nfold along x=163\r\nfold along y=111\r\nfold along x=81\r\nfold along y=55\r\nfold along x=40\r\nfold along y=27\r\nfold along y=13\r\nfold along y=6";
}
